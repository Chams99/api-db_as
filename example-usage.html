<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Database Chat Interface - Example</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .example {
            background: #f8f9fa;
            padding: 20px;
            border-left: 4px solid #007bff;
            margin: 20px 0;
            border-radius: 5px;
        }
        .code {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            margin: 10px 0;
        }
        .response {
            background: #f0fff4;
            border: 1px solid #48bb78;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .button:hover {
            background: #0056b3;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            text-align: center;
        }
        .status.connected {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.disconnected {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ü§ñ AI Database Chat Interface</h1>
        <p style="text-align: center; color: #666;">
            Example usage of the AI-powered database chat API
        </p>

        <div id="status" class="status disconnected">
            üî¥ Server Status: Checking...
        </div>

        <div class="example">
            <h3>üìã Health Check</h3>
            <p>Check if the server is running and healthy:</p>
            <div class="code">GET http://localhost:5000/health</div>
            <button class="button" onclick="checkHealth()">Test Health Check</button>
            <div id="health-response" class="response" style="display: none;"></div>
        </div>

        <div class="example">
            <h3>üí¨ Chat with Database</h3>
            <p>Ask questions about your product database:</p>
            <div class="code">POST http://localhost:5000/api/chat</div>
            <p><strong>Request Body:</strong></p>
            <div class="code">{
  "message": "Show me all toys under $50",
  "conversationHistory": []
}</div>
            <button class="button" onclick="testChat()">Test Chat API</button>
            <div id="chat-response" class="response" style="display: none;"></div>
        </div>

        <div class="example">
            <h3>üìÇ Get Categories</h3>
            <p>Retrieve all available product categories:</p>
            <div class="code">GET http://localhost:5000/api/chat/categories</div>
            <button class="button" onclick="getCategories()">Get Categories</button>
            <div id="categories-response" class="response" style="display: none;"></div>
        </div>

        <div class="example">
            <h3>üìä System Statistics</h3>
            <p>Get database and system statistics:</p>
            <div class="code">GET http://localhost:5000/api/chat/stats</div>
            <button class="button" onclick="getStats()">Get Statistics</button>
            <div id="stats-response" class="response" style="display: none;"></div>
        </div>

        <div class="example">
            <h3>üöÄ Quick Start</h3>
            <p>To start the server:</p>
            <div class="code"># Install dependencies
npm install

# Start in development mode
npm run dev

# Start in production mode
npm start</div>
        </div>

        <div class="example">
            <h3>üìù Sample Queries</h3>
            <p>Try these natural language queries:</p>
            <ul>
                <li>"Show me all electronics items"</li>
                <li>"Find items under $100"</li>
                <li>"What categories do you have?"</li>
                <li>"Show me highly rated books"</li>
                <li>"How many items are in the toys category?"</li>
                <li>"Find items with 'wireless' in the name"</li>
            </ul>
        </div>
    </div>

    <script>
        // Update status on page load
        updateStatus();

        async function updateStatus() {
            const statusDiv = document.getElementById('status');

            try {
                const response = await fetch('http://localhost:5000/health');
                if (response.ok) {
                    const data = await response.json();
                    statusDiv.className = 'status connected';
                    statusDiv.innerHTML = `üü¢ Server Status: ${data.status} (${data.environment})`;
                } else {
                    throw new Error('Server not responding');
                }
            } catch (error) {
                statusDiv.className = 'status disconnected';
                statusDiv.innerHTML = 'üî¥ Server Status: Not running (start with "npm run dev")';
            }
        }

        async function checkHealth() {
            const responseDiv = document.getElementById('health-response');
            responseDiv.style.display = 'block';
            responseDiv.innerHTML = 'Loading...';

            try {
                const response = await fetch('http://localhost:5000/health');
                const data = await response.json();

                responseDiv.innerHTML = `
                    <strong>Response:</strong><br>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                `;
            } catch (error) {
                responseDiv.innerHTML = `‚ùå Error: ${error.message}`;
            }
        }

        async function testChat() {
            const responseDiv = document.getElementById('chat-response');
            responseDiv.style.display = 'block';
            responseDiv.innerHTML = 'Loading...';

            try {
                const response = await fetch('http://localhost:5000/api/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        message: "Show me all toys under $50",
                        conversationHistory: []
                    })
                });

                const data = await response.json();

                responseDiv.innerHTML = `
                    <strong>AI Response:</strong><br>
                    ${data.response}<br><br>
                    <strong>Query Used:</strong> ${data.queryUsed}<br>
                    <strong>Results Count:</strong> ${data.results?.count || 0}
                `;
            } catch (error) {
                responseDiv.innerHTML = `‚ùå Error: ${error.message}`;
            }
        }

        async function getCategories() {
            const responseDiv = document.getElementById('categories-response');
            responseDiv.style.display = 'block';
            responseDiv.innerHTML = 'Loading...';

            try {
                const response = await fetch('http://localhost:5000/api/chat/categories');
                const data = await response.json();

                responseDiv.innerHTML = `
                    <strong>Available Categories:</strong><br>
                    ${data.categories.join(', ')}<br>
                    <strong>Total:</strong> ${data.count} categories
                `;
            } catch (error) {
                responseDiv.innerHTML = `‚ùå Error: ${error.message}`;
            }
        }

        async function getStats() {
            const responseDiv = document.getElementById('stats-response');
            responseDiv.style.display = 'block';
            responseDiv.innerHTML = 'Loading...';

            try {
                const response = await fetch('http://localhost:5000/api/chat/stats');
                const data = await response.json();

                responseDiv.innerHTML = `
                    <strong>Database Stats:</strong><br>
                    Total Items: ${data.database.totalItems}<br>
                    Active Items: ${data.database.activeItems}<br>
                    Categories: ${data.database.categories.join(', ')}<br><br>
                    <strong>System Status:</strong> ${data.system.environment}
                `;
            } catch (error) {
                responseDiv.innerHTML = `‚ùå Error: ${error.message}`;
            }
        }

        // Update status every 30 seconds
        setInterval(updateStatus, 30000);
    </script>
</body>
</html>
